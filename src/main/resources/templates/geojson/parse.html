<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∞—Ä—Å–∏–Ω–≥ GeoJSON</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #333;
        }

        .parse-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            max-width: 700px;
            width: 100%;
            padding: 50px 40px;
            text-align: center;
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .logo {
            font-size: 64px;
            margin-bottom: 20px;
            animation: float 3s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }

        h1 {
            font-size: 32px;
            font-weight: 700;
            color: #2d3748;
            margin-bottom: 12px;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 16px;
            color: #718096;
            margin-bottom: 40px;
            line-height: 1.6;
        }

        .info-card {
            background: #f7fafc;
            border-left: 4px solid #667eea;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 30px;
            text-align: left;
        }

        .info-card h3 {
            font-size: 18px;
            color: #2d3748;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-card p {
            font-size: 14px;
            color: #4a5568;
            line-height: 1.6;
        }

        .file-upload-section {
            margin: 30px 0;
            padding: 30px;
            background: #f7fafc;
            border-radius: 16px;
            border: 2px dashed #cbd5e0;
            transition: all 0.3s ease;
        }

        .file-upload-section:hover {
            border-color: #667eea;
            background: #edf2f7;
        }

        .file-upload-label {
            display: block;
            cursor: pointer;
            padding: 20px;
            border-radius: 12px;
            background: white;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            margin-bottom: 15px;
        }

        .file-upload-label:hover {
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.15);
        }

        .file-input {
            display: none;
        }

        .file-icon {
            font-size: 48px;
            margin-bottom: 12px;
        }

        .file-text {
            font-size: 16px;
            color: #4a5568;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .file-hint {
            font-size: 14px;
            color: #a0aec0;
        }

        .selected-file {
            margin-top: 15px;
            padding: 12px;
            background: #e6fffa;
            border: 1px solid #4ecdc4;
            border-radius: 8px;
            font-size: 14px;
            color: #234e52;
            display: none;
        }

        .selected-file.show {
            display: block;
        }

        .divider {
            display: flex;
            align-items: center;
            margin: 30px 0;
            color: #a0aec0;
            font-size: 14px;
        }

        .divider::before,
        .divider::after {
            content: '';
            flex: 1;
            height: 1px;
            background: #e2e8f0;
        }

        .divider span {
            padding: 0 15px;
        }

        .btn {
            display: inline-block;
            padding: 14px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            transition: all 0.3s ease;
            margin: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(102, 126, 234, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 16px rgba(255, 107, 107, 0.3);
        }

        .btn-secondary {
            background: #e2e8f0;
            color: #4a5568;
        }

        .btn-secondary:hover {
            background: #cbd5e0;
            transform: translateY(-2px);
        }

        .warning-box {
            background: #fff5f5;
            border-left: 4px solid #fc8181;
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
            text-align: left;
        }

        .warning-box h4 {
            font-size: 16px;
            color: #c53030;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .warning-box p {
            font-size: 14px;
            color: #742a2a;
            line-height: 1.6;
        }

        .success-box {
            background: #f0fff4;
            border-left: 4px solid #48bb78;
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
            text-align: left;
        }

        .success-box p {
            font-size: 14px;
            color: #22543d;
            line-height: 1.6;
        }

        .error-box {
            background: #fff5f5;
            border-left: 4px solid #fc8181;
            border-radius: 12px;
            padding: 16px;
            margin: 20px 0;
            text-align: left;
        }

        .error-box p {
            font-size: 14px;
            color: #742a2a;
            line-height: 1.6;
        }

        .actions {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-top: 30px;
        }

        .actions-row {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        @media (max-width: 768px) {
            .parse-container {
                padding: 30px 24px;
            }

            h1 {
                font-size: 24px;
            }

            .logo {
                font-size: 48px;
            }

            .actions-row {
                flex-direction: column;
            }

            .btn {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="parse-container">
        <div class="logo">üìÑ</div>
        <h1>–ü–∞—Ä—Å–∏–Ω–≥ GeoJSON</h1>
        <p class="subtitle">–ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª GeoJSON –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∞–π–ª</p>

        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ –∏–ª–∏ –æ—à–∏–±–∫–µ -->
        <div th:if="${success != null}" class="success-box">
            <p th:text="${success}"></p>
        </div>

        <div th:if="${error != null}" class="error-box">
            <p th:text="${error}"></p>
        </div>

        <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–º —Ñ–∞–π–ª–µ -->
        <div class="info-card">
            <h3>üìÅ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∞–π–ª</h3>
            <p><strong>sankt-peterburg.geojson</strong> - —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –æ –¥–æ—Ä–æ–∂–Ω–æ-—Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã—Ö –ø—Ä–æ–∏—Å—à–µ—Å—Ç–≤–∏—è—Ö –≤ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–µ. 
            –§–∞–π–ª –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –≤—ã –Ω–µ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å–≤–æ–π —Ñ–∞–π–ª.</p>
        </div>

        <!-- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –±–æ–ª—å—à–æ–º —Ñ–∞–π–ª–µ -->
        <div class="warning-box" th:if="${!hasData}">
            <h4>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</h4>
            <p>–§–∞–π–ª –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—á–µ–Ω—å –±–æ–ª—å—à–∏–º –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç—ã—Å—è—á–∏ –∑–∞–ø–∏—Å–µ–π. –ü–∞—Ä—Å–∏–Ω–≥ –º–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è.</p>
        </div>

        <!-- –§–æ—Ä–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø–∞—Ä—Å–∏–Ω–≥–∞ -->
        <form th:action="@{/geojson/parse}" method="post" enctype="multipart/form-data" id="parseForm">
            <!-- –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Ñ–∞–π–ª–∞ -->
            <div class="file-upload-section">
                <label for="fileInput" class="file-upload-label">
                    <div class="file-icon">üì§</div>
                    <div class="file-text">–í—ã–±–µ—Ä–∏—Ç–µ GeoJSON —Ñ–∞–π–ª</div>
                    <div class="file-hint">–ò–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —Ñ–∞–π–ª —Å—é–¥–∞</div>
                </label>
                <input type="file" 
                       id="fileInput" 
                       name="file" 
                       class="file-input" 
                       accept=".geojson,application/geo+json"
                       onchange="handleFileSelect(this)">
                <div id="selectedFile" class="selected-file"></div>
            </div>

            <!-- –†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å -->
            <div class="divider">
                <span>–∏–ª–∏</span>
            </div>

            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä—Å–∏–Ω–≥–µ -->
            <div class="info-card">
                <h3>‚ÑπÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç</h3>
                <p>–ï—Å–ª–∏ –≤—ã –∑–∞–≥—Ä—É–∑–∏–ª–∏ —Ñ–∞–π–ª, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –æ–Ω. –ï—Å–ª–∏ —Ñ–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω, 
                –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ñ–∞–π–ª <strong>sankt-peterburg.geojson</strong>.</p>
            </div>

            <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
            <div class="actions">
                <div class="actions-row">
                    <button type="submit" class="btn btn-primary">üöÄ –ù–∞—á–∞—Ç—å –ø–∞—Ä—Å–∏–Ω–≥</button>
                    <a th:href="@{/}" class="btn btn-secondary">üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
                </div>
            </div>
        </form>

        <!-- –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ –ë–î (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ) -->
        <div th:if="${hasData}" style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
            <form th:action="@{/geojson/clear}" method="post" style="display: inline;">
                <button type="submit" 
                        class="btn btn-danger" 
                        onclick="return confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö? –í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è.');">
                    üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
                </button>
            </form>
        </div>
    </div>

    <script>
        function handleFileSelect(input) {
            const file = input.files[0];
            const selectedFileDiv = document.getElementById('selectedFile');
            
            if (file) {
                selectedFileDiv.textContent = 'üìÑ –í—ã–±—Ä–∞–Ω —Ñ–∞–π–ª: ' + file.name + ' (' + formatFileSize(file.size) + ')';
                selectedFileDiv.classList.add('show');
            } else {
                selectedFileDiv.classList.remove('show');
            }
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ drag and drop
        const fileUploadSection = document.querySelector('.file-upload-section');
        const fileInput = document.getElementById('fileInput');

        fileUploadSection.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadSection.style.borderColor = '#667eea';
            fileUploadSection.style.background = '#edf2f7';
        });

        fileUploadSection.addEventListener('dragleave', (e) => {
            e.preventDefault();
            fileUploadSection.style.borderColor = '#cbd5e0';
            fileUploadSection.style.background = '#f7fafc';
        });

        fileUploadSection.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadSection.style.borderColor = '#cbd5e0';
            fileUploadSection.style.background = '#f7fafc';
            
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                const file = files[0];
                if (file.name.toLowerCase().endsWith('.geojson')) {
                    fileInput.files = files;
                    handleFileSelect(fileInput);
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ–º .geojson');
                }
            }
        });
    </script>
</body>
</html>
